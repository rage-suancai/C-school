指针数组与数组指针

前面我们了解了指针的一些基本操作 包括它与数组的一些关系 我们接着来看指针数组和数组指针 这两个词看着就容易搞混
不过哪个词再后面就哪个 我们先来看指针数组 虽然名字很像数组指针 但是它本质上是一个数组 不过这个数组是用于存放指针的数组

                    #include <stdio.h>

                    int main() {
                        int a, b, c;
                        int *arr[3] = {&a, &b, &c}; // 可以看到 实际上本质还是数组 只不过存的都是地址
                    }

因为这个数组中全都是指针 比如现在我们想要访问数组中第一个指针指向的地址:

                    #include <stdio.h>

                    int main() {
                        int a, b, c;
                        int *arr[3] = {&a, &b, &c};

                        *arr[0] = 999; // []运算符的优先级更高 所以这里先通过[0]取出地址 然后再使用*将值赋值到对应的地址上
                        printf("%d", a);
                    }

当然我们也可以用二级指针变量来得到指针数组的首元素地址:

                    #include <stdio.h>

                    int main() {
                        int *p[3]; // 因为数组内全是指针
                        int **pp = p; // 所以可以直接使用指向指针的指针来指向数组中的第一个指针元素
                    }

实际上指针数组还是很好理解的 那么数组指针呢? 可以看到指针在后 说明本质是一个指针 不过这个指针比较特殊
它是一个指向数组的指针(注意它的目标是整个数组 和我们之前认识的指针不同 之前认识的指针是指向某种类型变量的指针)

比如:

                    int *p; // 指向int类型的指针

而数组指针则表示指向整个数组:

                    int (*p)[3]; // 注意这里需要将*p括起来 因为[]的优先级更高

注意它的目标是整个数组 而不是普通的指针那样指向的是数组的首个元素:

                    int arr[3] = {111, 222, 333};
                    int (*p)[3] = &arr; // 直接对整数组再取一次地址(因为数组指针代表的是整个数组的地址)

那么现在已经取到了指向数组的指针 该怎么去使用呢?

                    #include <stdio.h>

                    int main() {
                        int arr[3] = {111, 222, 333};
                        int (*p)[3] = &arr; // 直接对整个数组再取一次地址

                        printf("%d, %d, %d" *(*p+0), *(*p+1), *(*p+2)); // 要获取数组中的每个元素 稍微有点麻烦
                    }

注意此时:

    > p             代表整个数组的地址
    > *p            表示所指向数组中首元素的地址
    > *p+i          表示所指向数组中第i个(0开始)元素的地址 (实际上这里的*p就是指向首元素的指针)
    > *(*p + i)     就是取对应地址上的值了

虽然在处理一维数组上感觉有点麻烦 但是它同样可以处理二维数组:

                    int arr[][3] = {{111, 222, 333}, {444, 555, 666}};
                    int (*p)[3] = arr; // 二维数组不需要再取地址了 因为现在维度提升 数组指针指向的是二维数组中的其中一个元素(因为元素本身就是一个数组)

比如现在我们需要访问第一个数组的第二个元素 根据上面p各种情况下的意义:

                    printf("%d", *(*p+1)); // 因为上面直接指向的就是第一个数组 所以想要获取第一个元素和之前是一模一样的

那么要是我们现在想要获取第二个数组中的最后一个元素呢?

                    printf("%d", *(*(p+1)+2)); // 首先*(p+1)为一个整体 表示第二个数组(因为是数组指针 所以这里+1一次性跳一个数组的长度) 然后再到外层+2表示数组中的第三个元素 最后再取地址 就是第二个数组的第三个元素了

当然也可以使用数组表示法:

                    printf("%d", p[1][2]); // 好家伙 这不就是二维数组的用法吗 没错 看似很难 你甚至可以认为这两用着是同一个东西